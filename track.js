!function(){var t=window.tjHub||{};t.dataLayer=window.dataLayer=window.dataLayer||[];const e="https://tj-track-bd.tj-studio-ltda.workers.dev/get-tracking-data";function n(){const t=document.getElementsByTagName("script");for(let e of t)if(e.src.includes("site_id="))try{return new URL(e.src).searchParams.get("site_id")}catch(t){}return"UNKNOWN_SITE"}t.site_id=n(),t.session_id=localStorage.getItem("tj_session_id")||`sess_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("tj_session_id",t.session_id);const a={get:t=>{const e=`; ${document.cookie}`.split(`; ${t}=`);return 2===e.length?e.pop().split(";").shift():null},getGaId:function(){const t=this.get("_ga");return t?t.replace(/^GA1\.\d\./,""):null},getGaSession:function(){const t=document.cookie.split(";");for(let e of t)if(e.trim().startsWith("_ga_")&&e.split(".").length>2)return e.split(".")[2];return null}};function o(){const t=new URLSearchParams(window.location.search);["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","fbclid"].forEach(e=>{t.has(e)&&localStorage.setItem("tj_"+e,t.get(e))})}function i(){return{utm_source:localStorage.getItem("tj_utm_source"),utm_medium:localStorage.getItem("tj_utm_medium"),utm_campaign:localStorage.getItem("tj_utm_campaign"),utm_content:localStorage.getItem("tj_utm_content"),utm_term:localStorage.getItem("tj_utm_term"),gclid:localStorage.getItem("tj_gclid"),fbclid:localStorage.getItem("tj_fbclid"),ga_client_id:a.getGaId(),ga_session_id:a.getGaSession(),fbp:a.get("_fbp"),fbc:a.get("_fbc")}}o();let r,s=0;window.addEventListener("scroll",function(){s=window.scrollY,clearTimeout(r),r=setTimeout(()=>{t.track("vertical_scroll",{scroll_y:s,screen_size:`${window.innerWidth}x${window.innerHeight}`,session_id:t.session_id})},3e3)}),t.track=function(n,a={}){a.url=window.location.href,a.referrer=document.referrer,a.session_id=t.session_id,a.site_id=t.site_id,a.screen_size=`${window.innerWidth}x${window.innerHeight}`,a.device=navigator.userAgent,a.timestamp=(new Date).toISOString(),t.dataLayer.push({event:n,data:a}),t.sending||(t.sending=setTimeout(()=>{let n=t.dataLayer.slice();t.dataLayer=[],navigator.sendBeacon?navigator.sendBeacon(`${e}?site_id=${t.site_id}`,JSON.stringify({events:n})):fetch(`${e}?site_id=${t.site_id}`,{method:"POST",body:JSON.stringify({events:n})}),t.sending=null},5e3))},t.track("page_view"),document.addEventListener("click",function(n){const a=n.target.closest("a, button");if(!a)return;let o={target:a.tagName.toLowerCase(),text:a.innerText?a.innerText.substring(0,50):"",class:a.className||"",id:a.id||"",href:a.href||""};"a"===a.tagName.toLowerCase()&&a.hostname!==window.location.hostname?(o.external=!0,t.track("click_outbound",o),navigator.sendBeacon(`${e}?site_id=${t.site_id}`,JSON.stringify({events:[{event:"click_outbound",data:o}]}))):t.track("click",o)}),document.addEventListener("submit",function(e){const n=e.target;if(!n||"form"!==n.tagName.toLowerCase())return;if("true"!==n.getAttribute("data-track"))return;let a=new FormData(n),o={},r={nome:null,email:null,tel:null};for(let[t,e]of a.entries()){if("string"!=typeof t||!t.toLowerCase().includes("senha")){o[t]=e;let n=t.toLowerCase();!r.nome&&(n.includes("nome")||n.includes("name"))?r.nome=e:!r.email&&n.includes("mail")?r.email=e:!r.tel&&(n.includes("tel")||n.includes("cel")||n.includes("whats"))&&(r.tel=e)}}t.track("form_submit",{action:n.action||"",method:n.method||"GET",form_id:n.id||"",form_class:n.className||"",fields:o,lead_info:r,marketing:i()})}),window.tjHub=t}();